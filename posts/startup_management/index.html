<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Startup management" /><meta name="author" content="Maxime Lair" /><meta property="og:locale" content="en" /><meta name="description" content="In this article, we will take a look at how init management is used in Linux, first by defining it, understanding its behavior and configuration, and some useful commands." /><meta property="og:description" content="In this article, we will take a look at how init management is used in Linux, first by defining it, understanding its behavior and configuration, and some useful commands." /><link rel="canonical" href="https://maxime-lair.github.io/maxime-lair/posts/startup_management/" /><meta property="og:url" content="https://maxime-lair.github.io/maxime-lair/posts/startup_management/" /><meta property="og:site_name" content="Bin/sh" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-06T19:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Startup management" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Maxime Lair" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Maxime Lair"},"description":"In this article, we will take a look at how init management is used in Linux, first by defining it, understanding its behavior and configuration, and some useful commands.","url":"https://maxime-lair.github.io/maxime-lair/posts/startup_management/","@type":"BlogPosting","headline":"Startup management","dateModified":"2022-01-06T19:00:00+01:00","datePublished":"2022-01-06T19:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://maxime-lair.github.io/maxime-lair/posts/startup_management/"},"@context":"https://schema.org"}</script><title>Startup management | Bin/sh</title><link rel="apple-touch-icon" sizes="180x180" href="/maxime-lair/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/maxime-lair/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/maxime-lair/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/maxime-lair/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/maxime-lair/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Bin/sh"><meta name="application-name" content="Bin/sh"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/maxime-lair/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/maxime-lair/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/maxime-lair/" alt="avatar" class="mx-auto"> <img src="/maxime-lair/assets/img/favicons/avatar.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/maxime-lair/">Bin/sh</a></div><div class="site-subtitle font-italic">Have fun reading</div></div><ul class="w-100"><li class="nav-item"> <a href="/maxime-lair/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/maxime-lair/roadTo/" class="nav-link"> <i class="fa-fw fas fa-road ml-xl-3 mr-xl-3 unloaded"></i> <span>ROAD TO DEVOPS</span> </a><li class="nav-item"> <a href="/maxime-lair/bin-sh/" class="nav-link"> <i class="fa-fw fas fa-tools ml-xl-3 mr-xl-3 unloaded"></i> <span>BIN-SH</span> </a><li class="nav-item"> <a href="/maxime-lair/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/maxime-lair/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/maxime-lair/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/maxime-lair/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/maxime-lair" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/maxime-lair/"> Home </a> </span> <span>Startup management</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Startup management</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/maxime-lair">Maxime Lair</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-01-06 19:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Thu, Jan 6, 2022, 7:00 PM +0100" >Jan 6, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1632 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>In this article, we will take a look at how init management is used in Linux, first by defining it, understanding its behavior and configuration, and some useful commands.</p><p><em>Note: Im running a CentOS9 Stream in this article, It came out in December 2021, I will not be covering UNIX or Windows, only Linux</em></p><p>We will be focusing on the newer system <em>systemd</em> - we will not talk about its ancestor (sysV) or competitors (upstart..)</p><h2 id="definition">Definition<a href="#definition" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>All processes running on the system are child processes of the <em>systemd</em> init process. It is an init system used to boostrap you from the kernel to user space.</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147766518-0ad30710-0a49-4b6e-b35c-afc396c4f9a7.png" alt="image" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147766425-2ccbf342-a66b-4cf5-980a-3b960e2715b2.png" alt="image" data-proofer-ignore></p><p><em>systemd</em> is rather new, as It was developped in 2010 and stable as of 2015. It is rapidly becoming the most used init process, but has some concerns on its inner security.</p><p>It will be considered as a system and service manager. For those that haven’t noticed, <a href="https://en.wikipedia.org/wiki/System_D">It is a play on words</a> refering to its quick adapting ability, but for real, the <strong>d</strong> in <em>systemd</em> refers to <em>daemon</em>, and If you need to refer to it, call it <strong>System daemon</strong>, not <strong>System D</strong>.</p><p>It is hard to define <em>systemd</em> as a good or bad news for Linux. While It is praised by developers and users alike for its reliable parallelism during boot and centralized management of processes, daemons, services and mount points, It strayed away from the UNIX philosophy by its design (e.g. mission creep/bloat feeling).</p><p>We will focus on the startup management part on <em>systemd</em> and the service process will be covered in another article.</p><h2 id="how-does-systemd-starts-">How does systemd starts ?<a href="#how-does-systemd-starts-" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Since RHEL 7 (Fedora 19+, Linux kernel 3.10.0-123), init scripts have been replaced with <em>service</em> units.</p><p>While its predecessor <em>sysV</em> was using runlevels to define its startup process, <strong>systemd</strong> uses target units to start itself. Retro-compatibility wise, the system daemon has only limited support for runlevels, It has a number of target units that can be directly mapped to these runlevels, but not all can be directly mapped to runlevels. This is why It is recommended to avoid using the <code class="language-plaintext highlighter-rouge">runlevel</code> command, and also the reason we will not cover the different runlevels.</p><p>Let’s focus on understanding how these <strong>units</strong> takes you from the boot phase to a useable system.</p><p><em>Target units</em> only purpose is to group together other systemd units through a chain of dependencies.</p><p>To determine which target unit is used by default, we will use <code class="language-plaintext highlighter-rouge">systemctl get-default</code></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147990539-ff9c1a45-4a5b-4e74-872e-63969f285145.png" alt="image" data-proofer-ignore></p><p>This represents the system end-goal to ensure our system is fully loaded, let’s check what It needs to be completed:</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147990740-be09ae78-fd90-4270-89a5-255aa9681c6a.png" alt="image" data-proofer-ignore></p><p><em>Note:</em> Unlike <code class="language-plaintext highlighter-rouge">Requires</code>, <code class="language-plaintext highlighter-rouge">After</code> does not explicitly activate the specified units. This means that to load the <em>default.target</em>, the system will only care about <em>basic.target</em>, and If we analyze it:</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147990694-4d08299e-55fc-4974-bc56-1cbba775fd68.png" alt="image" data-proofer-ignore></p><p>Let’s check what <em>system.slice</em> has in store. A slice unit is a concept for hierarchically managing resources of a group of processes. It is performed by creating a node in the <em>cgroup</em> tree to limit resource applied to a specific slice.</p><p>First, let’s understand what are <em>cgroups</em>, as they are an essential feature of the linux kernel (specially for containers).</p><h3 id="cgroups">cgroups<a href="#cgroups" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>cgroup</strong> is the Linux Control Group that limits, accounts for, and isolates the resource usage (CPU, memory, disk, I/O, network, etc..) of a collection of processes. The first version was developped at Google in 2006 and released in the linux kernel mainline in 2008. The version 2 was merged in linux kernel 4.5 (Fedora uses it since ~ 2019), no RHEL released with it yet at this time, my Centos 9 is on linux kernel 5.14, so this is still very new.</p><p>Main version difference is: unlike v1, <em>cgroup v2</em> has only a single process hierarchy and discriminates between processes, not threads.</p><p>One of the design goals of <em>cgroups</em> is to provide a unified interface, from controlling single processes (e.g. by using <code class="language-plaintext highlighter-rouge">nice</code>) to full operating system-level virtualization (e.g. LXC or docker), in order to provide:</p><ul><li>Resource limiting<li>Prioritization<li>Accounting<li>Control</ul><p>A control group (<em>cgroup</em>) is a collection of processes that are bound by the same criteria and associated with a set of parameters or limits. The kernel provides access to multiple controllers through the <em>cgroup</em> interface, these controllers can be Block IO, CPUSETS, HugeTLB, Memory, Network, Process number or RDMA.</p><p>You can check these collections through <strong>systemd</strong> with two commands:</p><p><code class="language-plaintext highlighter-rouge">systemd-cgls</code></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147994561-b7e7ab41-3fa2-4da0-a697-904f55eb04cb.png" alt="image" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147994639-af9a6056-adb7-43ff-8958-f0c167fd6ad3.png" alt="image" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">systemd-cgtop</code></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147994725-c144d867-e284-4c6f-9b54-d228f5a9863c.png" alt="image" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147994712-eaf8ac79-c623-4fbc-8061-48d0d76c1f24.png" alt="image" data-proofer-ignore></p><p>There is also the <code class="language-plaintext highlighter-rouge">tc</code> command, a user-space utility program used to configure linux kernel packet scheduler.</p><p>Various projects use <em>cgroups</em> as their basis, including <strong>Docker</strong>, <strong>Hadoop</strong>, <strong>Kubernetes</strong> and <strong>systemd</strong>.</p><p>You can find your currently defined cgroups in <em>/sys/fs/cgroup</em> directory</p><p><img data-src="https://user-images.githubusercontent.com/72258375/148071480-c004e04d-5c9b-4490-bd6d-38254596eae2.png" alt="image" data-proofer-ignore></p><p>Notice how we find back our cgroup defined by <em>system.slice</em> ; It itself will contain more cgroups defined in its hierarchy</p><p><img data-src="https://user-images.githubusercontent.com/72258375/148071867-57f9a276-b95f-4354-bdda-072114f1a9e5.png" alt="image" data-proofer-ignore></p><p>And its controllers (or subystem):</p><p><img data-src="https://user-images.githubusercontent.com/72258375/148072072-cd7c2160-6c08-45f3-869a-4d6e173503b1.png" alt="image" data-proofer-ignore></p><h3 id="systemslice">System.slice<a href="#systemslice" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Now that we understand how cgroups is used to limit ressources usage per task groups, we can check how It works when our system starts up.</p><p>We can check which units our <em>system.slice</em> is directly responsible for:</p><p><img data-src="https://user-images.githubusercontent.com/72258375/148075444-69ae40e9-e0d6-47f8-8baa-7d0c8990478f.png" alt="image" data-proofer-ignore></p><p><em>system.slice</em> is part of the four “.slice” units which form the basis of the hierarchy for assignment of resources for services, users and virtual machines/containers.</p><div class="table-wrapper"><table><thead><tr><th>Slice unit<th>Description<tbody><tr><td>-.slice<td>Root of the slice hierarchy, does not usually contain units directly but may be used to set defaults for the whole tree<tr><td>system.slice<td>By default, all system services started by <strong>systemd</strong> are found in this slice<tr><td>user.slice<td>By default, all user processes and services started on behalf of the user<tr><td>machine.slice<td>By default, all virtual machines/containers registered with <em>systemd-machined</em> are found in this slice</table></div><h2 id="bootup-process">Bootup process<a href="#bootup-process" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now that we understand how <em>.slice</em> units are used to control process resources through cgroups hierarchy tree, we go back to our <em>default.target</em> critical-chain</p><p><img data-src="https://user-images.githubusercontent.com/72258375/148084906-a272df62-d4d9-4932-9717-caece6135914.png" alt="image" data-proofer-ignore></p><p>As a reminder, a usual bootup process goes as follow:</p><ul><li>Power-up<li>System firmware (BIOS/UEFI/EFI, etc.) will do minimal hardware initialization<li>Boot loader stored on a persistent storage device (<strong>systemd-boot</strong> for UEFI, GRUB2, etc.) to invoke OS kernel from disk (or network)<li>The kernel will then mounts an in-memory file system, generated by <code class="language-plaintext highlighter-rouge">dracut</code>, usually an <em>initramfs</em>, and interprets it as a file system<li>initrd hands over control to the host’s system manager (e.g. <strong>systemd</strong>) stored in the root file system<li><strong>systemd</strong> will probe all remaining hardware, mount all necessary file systems and spawn all configured services</ul><p>The shutdown process does exactly the same as the bootup process, but in exact reverse.</p><p>You can check your bootloader configuration in <em>/boot/loader/entries/*-[kernel-version].conf</em></p><p><img data-src="https://user-images.githubusercontent.com/72258375/148090884-87fea3a3-205f-45e8-ab91-1be7e1e93516.png" alt="image" data-proofer-ignore></p><p>Let’s analyze each step to understand our bootup process. While this process is split up in various discrete steps, the boot-up process is highly parallelized so the order in which specific target units are reached is not deterministic, but still adheres to a limited amount of ordering structure.</p><p>In order to reach <em>multi-user.target</em>, we go through a few different targets (and their dependencies), namely:</p><ul><li>local-fs-pre.target<li>local-fs.target<li>sysinit.target<li>basic.target<li>network-pre.target<li>network-online.target</ul><p>If you wonder why this list is not the same as the one found in <em>default.target</em> configuration:</p><p><img data-src="https://user-images.githubusercontent.com/72258375/148094531-ea0dcb0c-b8a8-484c-80fe-3442ed3191bc.png" alt="image" data-proofer-ignore></p><p>This is because the critical-chain is a tree of <strong>required</strong> units, <em>Wants</em> is a weak dependency, if any of the wanted units does not start successfully, It has no impact on the <em>default.target</em> activation.</p><p>Here is an incomplete view of some dependency for targets chain:</p><p><img data-src="https://user-images.githubusercontent.com/72258375/148115181-00fbd595-23d5-4a03-ad2c-b73c0aae9a70.png" alt="image" data-proofer-ignore></p><p>Of course we are missing lots of service and others units, but If It helps to see how It enables parallelism.</p><h2 id="change-target">Change target<a href="#change-target" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now that we understand how our bootup process works in order to reach our <em>default.target</em> , how do we reverse that to make the system stop ?</p><p><strong>systemd</strong> gives you the ability to change to a different target unit in the current session (requires <code class="language-plaintext highlighter-rouge">root</code>).</p><p>Just use <code class="language-plaintext highlighter-rouge">systemctl isolate [target-name]</code> to switch into the target unit, which will immediately stops all others non-required units (use at your own risk).</p><p>This is useful in case we want to repair our system, in case It is unable to complete a regular booting process.</p><p>For example, <code class="language-plaintext highlighter-rouge">systemctl rescue</code> allows you to switch to <em>rescue.target</em>, which provides a convenient single-user environment and mount all local file systems. It does not activate network interfaces or multiple user sessions. It ressembles <code class="language-plaintext highlighter-rouge">systemctl isolate rescue.target</code> but sends an informative message to all currently logged users in the system (wall).</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147991663-3d4b7db0-d5f3-4d3b-891c-43d99a0f9c4c.png" alt="image" data-proofer-ignore></p><p>If you need to go further, you can use <code class="language-plaintext highlighter-rouge">systemctl emergency</code>, which provides the most minimal environment possible. It mounts the root file system only for reading, and does not attempt to mount any other local file systems.</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147991899-a3a622e0-a035-4f46-9be3-96357a797d32.png" alt="image" data-proofer-ignore></p><h2 id="system-power-management">System power management<a href="#system-power-management" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>systemd</strong>, as a system manager, will also handle the power management command whenever you want to stop, reboot, suspend it. Any commands you use is a symlink to <code class="language-plaintext highlighter-rouge">systemctl</code> utility.</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147992138-7199c6f2-2981-460d-bf9d-bacc1a7e51f8.png" alt="image" data-proofer-ignore></p><p>Each of these commands is a link to a target unit, which will try to stop the system as cleanly as possible.</p><p>A few differences to note:</p><ul><li><strong>halt</strong> terminates all processes and shuts down the cpu<li><strong>poweroff</strong> is similar to <em>halt</em> but also turns off the motherboard (lights, led, etc.)<li><strong>shutdown</strong> is similar to <em>poweroff</em> but runs shutdown scripts beforehand to stop things gracefully<li><strong>reboot</strong> is a <em>shutdown</em> and apply a hardware reset procedure so that the boot process takes over<li><strong>suspend</strong> saves the system state in RAM, and powers off most the device in the machine until It is turned back again<li><strong>hibernate</strong> saves the system state on the hard disk drive and powers off the machine until It is turned back again</ul><p><img data-src="https://user-images.githubusercontent.com/72258375/147993247-392abb0c-0e6f-4e5a-8cab-e9301bae7fe5.png" alt="image" data-proofer-ignore></p><h2 id="conclusion">Conclusion<a href="#conclusion" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We discovered how <strong>systemd</strong> takes you from the system bootup process to his <em>default.target</em> and how we can change this target to shutdown our system. There is much more to fully uncover this startup process, for example by applying cgroups to limit resources usage on a specific target.</p><p>Feel free to check out the credits below, as there were helpful in uncovering the surrounding shroud around <strong>systemd startup process</strong>.</p><blockquote><p>Credits</p><p>https://en.wikipedia.org/wiki/Systemd</p><p>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/chap-managing_services_with_systemd</p><p>https://www.computernetworkingnotes.com/linux-tutorials/</p><p>https://www.freedesktop.org/software/systemd/man/systemctl.html</p><p>https://www.kernel.org/doc/html/latest/admin-guide/cgroup-v1/cgroups.html</p><p>https://systemd.io</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/maxime-lair/categories/roadto/'>RoadTo</a>, <a href='/maxime-lair/categories/os-concepts/'>OS Concepts</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/maxime-lair/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/maxime-lair/tags/systemd/" class="post-tag no-text-decoration" >systemd</a> <a href="/maxime-lair/tags/initd/" class="post-tag no-text-decoration" >initd</a> <a href="/maxime-lair/tags/unit/" class="post-tag no-text-decoration" >unit</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Startup management - Bin/sh&url=https://maxime-lair.github.io/maxime-lair/posts/startup_management/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/maxime-lair/posts/sockets/">Sockets</a><li><a href="/maxime-lair/posts/networking_concepts/">Networking concepts</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/maxime-lair/tags/linux/">linux</a> <a class="post-tag" href="/maxime-lair/tags/bash/">bash</a> <a class="post-tag" href="/maxime-lair/tags/initd/">initd</a> <a class="post-tag" href="/maxime-lair/tags/network/">network</a> <a class="post-tag" href="/maxime-lair/tags/bus/">bus</a> <a class="post-tag" href="/maxime-lair/tags/cadvisor/">cadvisor</a> <a class="post-tag" href="/maxime-lair/tags/concurrency/">concurrency</a> <a class="post-tag" href="/maxime-lair/tags/container/">container</a> <a class="post-tag" href="/maxime-lair/tags/device/">device</a> <a class="post-tag" href="/maxime-lair/tags/docker/">docker</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/maxime-lair/posts/service_management/"><div class="card-body"> <em class="timeago small" date="2022-01-05 19:00:00 +0100" >Jan 5, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Service management</h3><div class="text-muted small"><p> In this article, we will take a look at how service management is used in Linux, first by defining it, understanding its behavior and configuration, and some useful commands. Note: Im running a Ce...</p></div></div></a></div><div class="card"> <a href="/maxime-lair/posts/process_management/"><div class="card-body"> <em class="timeago small" date="2022-01-01 19:00:00 +0100" >Jan 1, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Process Management</h3><div class="text-muted small"><p> In this article, we will talk about process management in any IT operation, we will start by defining what process and managing them means, what commands can help us achieve this, and common pitfal...</p></div></div></a></div><div class="card"> <a href="/maxime-lair/posts/memory_and_storage/"><div class="card-body"> <em class="timeago small" date="2022-01-03 19:00:00 +0100" >Jan 3, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Memory and storage</h3><div class="text-muted small"><p> In this article, we will take a look at how memory and storage interact in Linux, the different technology available, and their perks and defaults Note: Im running a CentOS9 Stream in this article...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/maxime-lair/posts/service_management/" class="btn btn-outline-primary" prompt="Older"><p>Service management</p></a> <a href="/maxime-lair/posts/posix_basics/" class="btn btn-outline-primary" prompt="Newer"><p>Posix basics</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/maxime-lair">Maxime Lair</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/maxime-lair/tags/linux/">linux</a> <a class="post-tag" href="/maxime-lair/tags/bash/">bash</a> <a class="post-tag" href="/maxime-lair/tags/initd/">initd</a> <a class="post-tag" href="/maxime-lair/tags/network/">network</a> <a class="post-tag" href="/maxime-lair/tags/bus/">bus</a> <a class="post-tag" href="/maxime-lair/tags/cadvisor/">cadvisor</a> <a class="post-tag" href="/maxime-lair/tags/concurrency/">concurrency</a> <a class="post-tag" href="/maxime-lair/tags/container/">container</a> <a class="post-tag" href="/maxime-lair/tags/device/">device</a> <a class="post-tag" href="/maxime-lair/tags/docker/">docker</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/maxime-lair/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/maxime-lair/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/maxime-lair/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
