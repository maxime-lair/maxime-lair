<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="File systems" /><meta name="author" content="Maxime Lair" /><meta property="og:locale" content="en" /><meta name="description" content="In this article, we will dive into the linux file systems, from the different format, its structure, the file types and some facts about partitions and mounts." /><meta property="og:description" content="In this article, we will dive into the linux file systems, from the different format, its structure, the file types and some facts about partitions and mounts." /><link rel="canonical" href="https://maxime-lair.github.io/maxime-lair/posts/file_systems/" /><meta property="og:url" content="https://maxime-lair.github.io/maxime-lair/posts/file_systems/" /><meta property="og:site_name" content="Bin/sh" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-02T19:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="File systems" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Maxime Lair" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Maxime Lair"},"description":"In this article, we will dive into the linux file systems, from the different format, its structure, the file types and some facts about partitions and mounts.","url":"https://maxime-lair.github.io/maxime-lair/posts/file_systems/","@type":"BlogPosting","headline":"File systems","dateModified":"2022-01-02T19:00:00+01:00","datePublished":"2022-01-02T19:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://maxime-lair.github.io/maxime-lair/posts/file_systems/"},"@context":"https://schema.org"}</script><title>File systems | Bin/sh</title><link rel="apple-touch-icon" sizes="180x180" href="/maxime-lair/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/maxime-lair/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/maxime-lair/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/maxime-lair/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/maxime-lair/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Bin/sh"><meta name="application-name" content="Bin/sh"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/maxime-lair/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/maxime-lair/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/maxime-lair/" alt="avatar" class="mx-auto"> <img src="/maxime-lair/assets/img/favicons/avatar.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/maxime-lair/">Bin/sh</a></div><div class="site-subtitle font-italic">Have fun reading</div></div><ul class="w-100"><li class="nav-item"> <a href="/maxime-lair/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/maxime-lair/roadTo/" class="nav-link"> <i class="fa-fw fas fa-road ml-xl-3 mr-xl-3 unloaded"></i> <span>ROAD TO DEVOPS</span> </a><li class="nav-item"> <a href="/maxime-lair/bin-sh/" class="nav-link"> <i class="fa-fw fas fa-tools ml-xl-3 mr-xl-3 unloaded"></i> <span>BIN-SH</span> </a><li class="nav-item"> <a href="/maxime-lair/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/maxime-lair/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/maxime-lair/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/maxime-lair/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/maxime-lair" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/maxime-lair/"> Home </a> </span> <span>File systems</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>File systems</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/maxime-lair">Maxime Lair</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-01-02 19:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 2, 2022, 7:00 PM +0100" >Jan 2, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3023 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><p>In this article, we will dive into the linux file systems, from the different format, its structure, the file types and some facts about partitions and mounts.</p><p><em>My lab is running on a Centos 9 Stream, which came out this very month. Most of this will apply to Linux distribution, I will not cover Unix or Windows command.</em></p><h2 id="definition">Definition<a href="#definition" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><a href="https://tldp.org/LDP/intro-linux/html/sect_03_01.html">From TLDP: </a> A simple description of the UNIX system, also applicable to Linux, is this:</p><blockquote><p>“On a UNIX system, everything is a file; if something is not a file, it is a process.”</p></blockquote><p>This statement is true because there are special files that are more than just files (named pipes and sockets, for instance), but to keep things simple, saying that everything is a file is an acceptable generalization. A Linux system, just like UNIX, makes no difference between a file and a directory, since a directory is just a file containing names of other files. Programs, services, texts, images, and so forth, are all files. Input and output devices, and generally all devices, are considered to be files, according to the system.</p><p>In order to manage all those files in an orderly fashion, man likes to think of them in an ordered tree-like structure on the hard disk, as we know from MS-DOS (Disk Operating System) for instance. The large branches contain more branches, and the branches at the end contain the tree’s leaves or normal files. For now we will use this image of the tree, but we will find out later why this is not a fully accurate image.</p><p>This way of thinking in tree is redundant in OOP (Metholds are held by Class that implements Interfaces), blockchain or version control (Git branches).</p><h2 id="different-file-system">Different file system<a href="#different-file-system" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Before storing any data on your file system, your storage device must first be formatted to a type understood by the operating system. There is too many formats to name them, but we can start with the most popular ones:</p><ul><li>F2FS<li>Ext4<li>XFS<li>Btrfs</ul><p>They all have their perks and defaults (stability, performance, OS support, etc.), you will use one depending on your usecase, there is bad and good answers as long as they are reasoned.</p><p>We can check our own file format with <em>fdisk</em> <img data-src="https://user-images.githubusercontent.com/72258375/147471121-a6ec7d62-6f12-4a1f-8a94-593fc6b8199a.png" alt="image" data-proofer-ignore></p><p>And check on a specific partition which format to use is available: <img data-src="https://user-images.githubusercontent.com/72258375/147471518-f4a7f725-5418-4484-b9d4-a22f1ec6aaf3.png" alt="image" data-proofer-ignore></p><h3 id="flash-media-f2fs">Flash media (F2FS)<a href="#flash-media-f2fs" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Without diving too deep, all you need to know is there is two types of flash memory: NOR and NAND logic. They share the same cell design, but are connected differently, which makes NOR able to random access and NAND restrained to page access. This makes NOR 60% physically larger than NAND flash. As a result, NOR is better for reading but worse for storing data, while NAND is quick at writing but less endurant.</p><p>Now that you know that, you will understand why a specific file system format is better for some storage device than others.</p><p>Let’s say you have a NAND flash memory-based storage devices like a SSD or SD Card. It is not surprising as they are becoming the most used storage device for servers and mobile devices due to their speed, noise and reliability. From what we just learned, they are quick to write into, but last less time. Can we use a file system that address their issues while supporting its strenghts ?</p><p>That’s what Samsung did with <em>F2FS</em>, but It is hard to predict if they will become the most common filesystem for flash devices.</p><h3 id="ext4">Ext4<a href="#ext4" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>This filesystem format stands for <strong>Extended File system</strong> and It is the default one in recent Linux. It is backwards compatible with former iterations (ext3, etc.) and useable in Windows 10 since 2016 and macOS through extFS.</p><p>It released in 2008 and has stood as one of the most used file system format for more than a decade now. Google is one of their main users since 2010. This is why It is the default format for android phones today. My (humble) guess is ext4 will slowly (~ 10 years) decline to make room for more modern file systems format.</p><p>It supports up to 1 Exabyte volumes (1000 To) and file size up to 16 Terabytes (TB).</p><h3 id="xfs">XFS<a href="#xfs" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>This format will probably overthrow ext4, as It was built for performance and is mainly used on storage that are constantly reading and writing data.</p><p>To compare it with ext4, XFS supports up to 16 Exabytes volumes and 8 Exabytes file size (i.e. 16 times larger and 500 times larger than ext4). It also is optimized for quicker crash recovery thanks to its metadata journaling.</p><p>It is supported by most operating systems, and can be used in google cloud for <em>container-optimized OS</em>.</p><h3 id="btrfs">BtrFS<a href="#btrfs" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>As the last file system format we check, with previous ones focused on flash, wide-support and performance, we will study one mainly used for long-term storage (for NAS, etc).</p><p>It includes snapshots and self-healing mechanisms. Facebook is one of their users, much like Parrot project and Tripadvisor. It is the least popular ones among the four, as It is one of the most recent (~ stable as of 2013). As soon as people starts to use it and understand the snapshot perks, It might gain more traction in the future.</p><h2 id="linux-file-system-structure">Linux file system structure<a href="#linux-file-system-structure" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now that we have seen some filesystem format, we can focus on the linux file system structure.</p><p>Once you decide on F2FS, ext4, XFS or BtrFS format, linux will build its directory tree. It is defined by the <em>FHS</em> (Filesystem Hierarchy standard) but It is a “trailing standard” for most distributions.</p><p>For example, all Linux distribution share the same root directory called <code class="language-plaintext highlighter-rouge">/</code> and essentials binaries needed in single-user mode are located in <code class="language-plaintext highlighter-rouge">/bin</code>. But they don’t all possess a <code class="language-plaintext highlighter-rouge">/run</code> directory.</p><p>In CentOS 9:</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147477010-0e707d11-3fde-49bf-9349-33a41b3eed89.png" alt="image" data-proofer-ignore></p><p><em>Note</em> All symlink (bin, sbin, lib, lib64) points to <code class="language-plaintext highlighter-rouge">/usr</code></p><p>Let’s check each subdirectories, and understand what type of files we could find there</p><h3 id="useful-tools">Useful tools<a href="#useful-tools" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>To help us navigate through this filesystem, we can use some nice external utilities that nicely print file systems like:</p><ul><li><em>nnn (C based)</em></ul><p><img data-src="https://user-images.githubusercontent.com/72258375/147481605-6289cb1d-6928-4a40-9eb9-a5db70695ca1.png" alt="image" data-proofer-ignore></p><ul><li><em>xplr (made in Rust)</em></ul><p><img data-src="https://user-images.githubusercontent.com/72258375/147480501-4d047621-1d19-4010-b5f1-bba5e572504f.png" alt="image" data-proofer-ignore></p><ul><li><em>midnight_commander (C based)</em></ul><p><img data-src="https://user-images.githubusercontent.com/72258375/147482379-caecf9e3-9bab-42f7-bd69-0e99e99a8ac8.png" alt="image" data-proofer-ignore></p><ul><li><em>ranger (made in Python)</em></ul><p><img data-src="https://user-images.githubusercontent.com/72258375/147480010-78787424-c548-4b2d-96d1-d8bba80f286b.png" alt="image" data-proofer-ignore></p><p>These tools are optional, but they can help having a better top-level view of the structure.</p><h3 id="root-subdirectories">Root subdirectories<a href="#root-subdirectories" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="table-wrapper"><table><thead><tr><th>Subdirectory<th>Description<tbody><tr><td><code class="language-plaintext highlighter-rouge">/bin</code><td>Contains binaries (Over 260M and 1300 files), this directory has evolved overtime. In the past, It contained the minimum number of binaries needed to operate the system (like busybox). Now, It’s merged with non-essential binaries (multi-user mode), and <em>/bin</em> is just a symlink for backwards compatibility. You should never install a binary here, only the ones provided by the OS. Prefer using <strong>/usr/local/bin</strong><tr><td><code class="language-plaintext highlighter-rouge">/boot</code><td>Contains boot loader files responsible for booting the server (efi, grub, loader and the kernel <strong>vmlinuz</strong>), this directory is critical for loading linux on reboot<tr><td><code class="language-plaintext highlighter-rouge">/dev</code><td>Stands for <strong>device</strong>, lists references to all CPU peripheral hardware, which are files with special properties, tty are for terminals (USB, serial port), sd for mass-storage driver, mem for main memory, hd for IDE driver, and pt for pseudo-terminals. There is three types: character, block and pseudo devices.<tr><td><code class="language-plaintext highlighter-rouge">/etc</code><td>Host-specific system-wide configuration files, It only contains static files. One notable subdirectory is <strong>/etc/opt</strong> used for add-on configuration packages<tr><td><code class="language-plaintext highlighter-rouge">/home</code><td>Users home directories, containing all their saved files and settings<tr><td><code class="language-plaintext highlighter-rouge">/lib</code><td>Libraries used by binaries and compilers (like libncurses or motd). You can check what libraries a binary uses with <strong>ldd</strong> command<tr><td><code class="language-plaintext highlighter-rouge">/media</code><td>Mount points for removable media such as CD-ROMs, USB drives<tr><td><code class="language-plaintext highlighter-rouge">/mnt</code><td>Temporarily mounted filesystems, you can create mount points anywhere in the system, but It is standard convention (and sheer praticality) to not litter the file system with randomly placed mount points<tr><td><code class="language-plaintext highlighter-rouge">/opt</code><td>Used for third-party application without dependency outside of their package, It is supposed to be self-contained<tr><td><code class="language-plaintext highlighter-rouge">/proc</code><td>Virtual filesystem (only available at runtime) providing process and kernel information as files, usually a <strong>procfs</strong> which create a hierarchical file-like structure used to dynamically access process data held in the kernel without using tracing methods or direct access to kernel memory<tr><td><code class="language-plaintext highlighter-rouge">/root</code><td>Home directory of your system boss (root user)<tr><td><code class="language-plaintext highlighter-rouge">/run</code><td>Recent subdirectory, It holds run-time variable data. It contains information about the running system since last boot, like currently logged-in users and running daemons. They are removed or truncated at the next boot process<tr><td><code class="language-plaintext highlighter-rouge">/sbin</code><td>Contains essential system binaries, used for maintenance or administrative tasks. Locally installed binaries should be sent to <strong>/usr/local/sbin</strong>. We may find <em>fdisk, lilo, init, ip</em>, and interestingly enough, we may find some these binaries in <em>/etc</em> in older distributions<tr><td><code class="language-plaintext highlighter-rouge">/srv</code><td>Holds site-specific data which is served by the system (ftp, rsync, www, cvs)<tr><td><code class="language-plaintext highlighter-rouge">/sys</code><td>It is a virtual file system that can be accessed to set or obtain information about the kernel’s view of the system. It is different from <em>/dev</em> as the latter contains the actual devices files without going through the kernel, while <em>/sys</em> is an interface to the kernel, much like <em>/proc</em>. It contains informations on drivers, busses, network and much <a href="https://www.kernel.org/doc/Documentation/filesystems/sysfs.txt">more</a>. Also <em>/proc</em> is older and less structured.<tr><td><code class="language-plaintext highlighter-rouge">/tmp</code><td>Contains files that are required temporarily, like lock files. It is one of the few subdirectory of <em>/</em> that does not require to be superuser<tr><td><code class="language-plaintext highlighter-rouge">/usr</code><td>Usually contains by far the largest share of data on a system (Here 3G). It contains user binaries (in <em>/usr/bin</em>), libraries (<em>/usr/lib</em>), etc. It is deemed as shareable, read-only data and must not be written to. Any information that is host specific or varies with time is stored elsewhere.<tr><td><code class="language-plaintext highlighter-rouge">/var</code><td>Contains variable data like system logging files, mail and printer spool directories. Some portions are not shareable between systems, like <em>/var/log</em> or <em>/var/lock</em>, while other may be shared, like <em>/var/mail</em> or <em>/var/spool/news</em>.</table></div><p>Some directories are more critical than others, and can be put onto separate partitions or systems, for easier backup, due to network topology or security concerns.</p><p>‘Mountable’ (Non-critical) directories are: <em>/home</em> <em>/mnt</em> <em>/tmp</em> <em>/var</em> Essential directories for booting are : <em>/usr</em> <em>/boot</em> <em>/dev</em> <em>/etc</em> <em>/lib</em> and <em>/proc</em></p><h2 id="file-types">File types<a href="#file-types" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now that we know what each directory purpose is, we can take a look further into the file system. After directory comes files, so let’s check each of them !</p><p>Before diving deeper, we need to understand the concept of inode</p><h3 id="inode">Inode<a href="#inode" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Linux filesystems are hard to understand, especially for a computer working with 0 and 1. How does our system understand its structure ? That’s when an inode is essential, It’s an index node that describes the file attributes such as the physical location on the hard drive, permission privileges, in short all the metadata that we know of a file. It is stored separately from the files themselves. Each filesystem generate its inode stable to identify each file It holds.</p><p>For every file on your file system, there is an inode containing 16 KB of this file metadata. We can check this number with <em>df</em></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147488910-2f1194fe-d31e-45aa-8698-369728712bcb.png" alt="image" data-proofer-ignore></p><p>How do we check a file’s inode ?</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147489017-08bcaeda-19b5-4daf-9c38-372a7c5d4735.png" alt="image" data-proofer-ignore></p><p>Here we can see each file types possess an inode, even links or directory.</p><p>Of course there is more advanced operations available on an Inode, but know for example that an inode structure depends on its file type, like a directory holding a list of inodes of the files It contains.</p><h3 id="regular-file">Regular file<a href="#regular-file" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>A regular file can be created with <em>touch</em> and have no special attributes</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147489309-59448368-1df2-483e-b0aa-a92a0b292bd5.png" alt="image" data-proofer-ignore></p><h3 id="directory">Directory<a href="#directory" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>We can create a directory with <em>mkdir</em> which can be later recognized with the attribute <em>d</em></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147489408-28b533eb-5d8a-49ed-a725-2a7ba60faf83.png" alt="image" data-proofer-ignore></p><p>And we can check its inode and file attribute with <em>stat</em></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147489838-3f6f1712-3986-4a51-9054-6bc40d3d2bb6.png" alt="image" data-proofer-ignore></p><h3 id="link">Link<a href="#link" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Links are created with <em>ln</em>, and there is two types:</p><ul><li>Hard link (default) - the new file will share the inode number with the original file</ul><p>It is only possible to hardlink a regular file, not a directory.</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147490072-13b1789f-ed2c-4049-85f1-4b36baf26972.png" alt="image" data-proofer-ignore></p><ul><li>Symbolic ( <em>-s</em> parameter) - It creates a new file (with its own inode) pointing to the original file address</ul><p><img data-src="https://user-images.githubusercontent.com/72258375/147490054-18696bb9-f535-4e9d-bef6-23187cd2a5f7.png" alt="image" data-proofer-ignore></p><p>Symbolic links can be applied to all types of files.</p><p>And if we try to access its contents, It makes it appear as if we are accessing the real file:</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147490220-5603a7b4-8a8c-473c-9f1c-b8ec24ca9846.png" alt="image" data-proofer-ignore></p><p>Notice how the inode is identical on the <em>regular.file</em> and <em>hardlink</em> (1016310<em>49</em>) but different on the <em>symlink</em> (1016310<em>50</em>)</p><p>If the original file (<strong>regular.file</strong>) was to move somewhere else, the symlink would break (as the file address changed), but the hardlink would still point to the file as It retains his inode.</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147490679-bff60c07-fee9-4b50-8154-d2dae4f53128.png" alt="image" data-proofer-ignore></p><p>Whether we move the file, or change its content, the hardlink will still access the right file content</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147490778-8e8be230-e1ff-4acc-a4fc-4479b1d4a45f.png" alt="image" data-proofer-ignore></p><p>Hardlinks will only break if the file is moved to another volume.</p><p>While symbolic links will only break if the original file is moved or deleted, but It can be used to reference across volumes.</p><p>Hardlinks are less and less present in Linux, as they mostly shift towards symbolic links, but can still be encountered in smaller distribution like BusyBox, as It saves space on the drive.</p><h3 id="special-file">Special file<a href="#special-file" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Also named device file, It is an interface for a device driver that appear in a file system as It It were an ordinary file. They are three types:</p><ul><li>Block devices - works with fixed-size blocks (see buffers) and large output of data, such as with a hard-drive</ul><p>You can find them with <em>lsblk</em></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147492302-89fa82e7-8362-4d32-b3a2-e28768c965fb.png" alt="image" data-proofer-ignore></p><ul><li>Character devices - can only send one character at a time, pratical in an internet connection I could not find any command for finding characters devices (unless you want to search the entire file structure), but you can find them in <em>/sys/dev/char/</em></ul><p><img data-src="https://user-images.githubusercontent.com/72258375/147492079-04cfb3de-eb7d-4af1-b860-d7dc55ebaaf4.png" alt="image" data-proofer-ignore></p><ul><li>Pseudo-devices - It is a device driver without an actual device</ul><p>They serve pratical purpose, like a virtual sinkhole, or producing random data</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147492780-acd3bfd7-aa3b-4a4b-8f5b-cc85b7979559.png" alt="image" data-proofer-ignore></p><h3 id="socket">Socket<a href="#socket" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Sockets are used to communicate between programs. There is two types:</p><ul><li>Stream sockets (using TCP as their underlying transport protocol)<li>Datagram sockets (using UDP)<li>Unix Domain Sockets (Using IPC - SOCK_STREAM)</ul><p>You can find them by checking your opened sockets with <em>ss</em> (netstat replacement) in <em>/proc/{PID}/fd</em></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147493356-6eb61d2e-a3fd-477b-ad87-2dbbfe35cf0c.png" alt="image" data-proofer-ignore></p><p>Or look for open files with lsof</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147493636-f87fefb3-c819-4159-b7f2-c40f893f1cde.png" alt="image" data-proofer-ignore></p><p>Alternatively, you can use find on specific file type (here named pipe and sockets)</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147493867-b337bce0-3974-4ae1-be1f-db777a71143e.png" alt="image" data-proofer-ignore></p><h3 id="named-pipe">Named pipe<a href="#named-pipe" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>A pipe has a read end and a write end. Data written to the write end of a pipe can be read from the read end of the pipe.</p><p>As opposed to unnamed pipe, like the one to string together commands like</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147494196-1623ec09-228a-4cc0-b869-e7fb70876449.png" alt="image" data-proofer-ignore></p><p>A named pipe, also known as <em>First In First Out</em>, is similar to a pipe but with a name on the filesystem.</p><p>Processes can access this special file for reading and writing, and provides bidirectional communication.</p><p>It is created with <strong>mkfifo</strong> and <strong>mknod</strong> (p for FIFO)</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147495963-2bc42250-dae1-4559-8e71-15a0d913a981.png" alt="image" data-proofer-ignore></p><p>And now we can simply use them to transfer data by specifying the pipe name. Here we use two shells, one for sending the data, the other to receive and compress it.</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147496258-bab99cfb-fc1d-44c9-a3f4-b42034b4d37a.png" alt="image" data-proofer-ignore></p><h2 id="partitions">Partitions<a href="#partitions" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>A hard disk can be divided into several partitions that will function as If It were a separate hard disk. The idea is that if you have one hard disk, and you want two operating systems on it, you can divide the disk into two. This information is stored in its first sector, also called <em>Master boot record (MBR)</em>, of the disk. This is the sector the BIOS reads in and starts when the machine is first booted. This MBR contains the partition table to check which partition is active (i.e. bootable) and reads the partition’s boot sector (in case of Linux, its <em>/boot</em>)</p><p>We can list our partitions with <em>lsblk</em></p><p><img data-src="https://user-images.githubusercontent.com/72258375/147497253-e9c4e4cc-17a0-4687-91b7-399c8e42c3df.png" alt="image" data-proofer-ignore></p><p>We can see our disk <em>sda</em> is split into two partitions:</p><ul><li>sda1 (containing the first sector <em>/boot</em>)<li>sda2 (containing our 49G data and swap)<ul><li>cs-root (containing our <em>/</em> filesystem)<li>cs-swap (containing our swap volume)</ul></ul><p>Disks are automatically named sd{a..b..c…z}</p><p><em>LVM</em> just means <em>logical volume manager</em>, used to create logical storage volumes with greater flexibility than partitions, such as resizeable storage pools to extend or reduce the volume size without reformatting or repartitioning the underlying disk devices.</p><p>Also, a partition can be a primary partition of extended partitions. Consider just main partition and sub-partition if this vocabulary is too complex, they were just made like this because original partitioning scheme for hard disks were limited to four (primary) partitions.</p><h3 id="data-partition">Data partition<a href="#data-partition" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Considered a normal Linux system data, including the root partition containing all the data to start up and run the system</p><p>We will often find a few partitions on the system:</p><ul><li><em>/</em> ~ 3-5 GB+ and only ext4 on RHEL distrib<li><em>/boot</em> ~ 250 MB+ and only ext4 on RHEL distrib<li><em>/home</em> ~ 100 MB+</ul><h3 id="swap-partition">Swap partition<a href="#swap-partition" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Expansion of the computer’s physical memory, they are used to support virtual memory, and data is written to a swap partition when there is not enough RAM to store the data your system is processing.</p><p>Over the past decade, the recommendend amount of swap space increased linearly with the amount of RAM in the system.</p><p>The <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/installation_guide/s2-diskpartrecommend-x86">recommended swap space</a> is as follow:</p><div class="table-wrapper"><table><thead><tr><th>Amount of RAM in the system<th>Recommended swap space<tbody><tr><td>&lt; 2GB<td>2 times the amount of RAM<tr><td>2-8GB<td>Equal the amount of RAM<tr><td>8+GB<td>At least 4 GB</table></div><h2 id="mounts">Mounts<a href="#mounts" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>All partitions are attached to the system via a mount point. The mount point defines the place of a particular data set in the file system. They can be connected <em>anywhere</em> on the file system, but It is bad practice to do it outside of root subdirectories.</p><p>You can check your partition in <em>/proc/mounts</em> or through <em>df</em> utility</p><p><img data-src="https://user-images.githubusercontent.com/72258375/147497957-ece4551c-50e2-46b9-8406-9184dccc987e.png" alt="image" data-proofer-ignore></p><h2 id="to-go-further">To go further<a href="#to-go-further" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We covered formatting the filesystem through different format, partitioning it into logical volumes to then be mounted onto your file system, which handles different files types through inodes and binaries.</p><p>There was a lot to uncover, and I was not expecting it to take this long, but I wanted to give a full picture of what file system are like, from the storage to its terminal.</p><p>Each filesystem format has their own implementations, and could be interesting to check at a low-level. We could perform a write/read tests to check which ones are more performant.</p><p>There is a lot of commands available to play with files in Linux, like sed/awk/grep/sort/cut, and they will be covered in a later article.</p><p>Check out some links below to dive deeper into the subject.</p><blockquote><p>Credits</p><p>https://linuxiac.com/linux-file-system-types-explained-which-one-should-you-use/</p><p>https://www.linux.com/training-tutorials/linux-filesystem-explained/</p><p>https://opensource.com/life/16/10/introduction-linux-filesystems</p><p>https://tldp.org/LDP/intro-linux/html/sect_03_01.html</p><p>https://en.wikipedia.org/wiki/Flash_memory</p><p>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9-beta</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/maxime-lair/categories/roadto/'>RoadTo</a>, <a href='/maxime-lair/categories/os-concepts/'>OS Concepts</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/maxime-lair/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/maxime-lair/tags/filesystem/" class="post-tag no-text-decoration" >filesystem</a> <a href="/maxime-lair/tags/pipe/" class="post-tag no-text-decoration" >pipe</a> <a href="/maxime-lair/tags/mount/" class="post-tag no-text-decoration" >mount</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=File systems - Bin/sh&url=https://maxime-lair.github.io/maxime-lair/posts/file_systems/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/maxime-lair/posts/sockets/">Sockets</a><li><a href="/maxime-lair/posts/networking_concepts/">Networking concepts</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/maxime-lair/tags/linux/">linux</a> <a class="post-tag" href="/maxime-lair/tags/bash/">bash</a> <a class="post-tag" href="/maxime-lair/tags/initd/">initd</a> <a class="post-tag" href="/maxime-lair/tags/network/">network</a> <a class="post-tag" href="/maxime-lair/tags/bus/">bus</a> <a class="post-tag" href="/maxime-lair/tags/cadvisor/">cadvisor</a> <a class="post-tag" href="/maxime-lair/tags/concurrency/">concurrency</a> <a class="post-tag" href="/maxime-lair/tags/container/">container</a> <a class="post-tag" href="/maxime-lair/tags/device/">device</a> <a class="post-tag" href="/maxime-lair/tags/docker/">docker</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/maxime-lair/posts/memory_and_storage/"><div class="card-body"> <em class="timeago small" date="2022-01-03 19:00:00 +0100" >Jan 3, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Memory and storage</h3><div class="text-muted small"><p> In this article, we will take a look at how memory and storage interact in Linux, the different technology available, and their perks and defaults Note: Im running a CentOS9 Stream in this article...</p></div></div></a></div><div class="card"> <a href="/maxime-lair/posts/io_management/"><div class="card-body"> <em class="timeago small" date="2022-01-04 19:00:00 +0100" >Jan 4, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>IO management</h3><div class="text-muted small"><p> In/Out management on Linux allows us to understand how data flows in Linux, from information coming from the network card, to the hard-drive, passing by CPU, RAM or others devices. All systems wil...</p></div></div></a></div><div class="card"> <a href="/maxime-lair/posts/service_management/"><div class="card-body"> <em class="timeago small" date="2022-01-05 19:00:00 +0100" >Jan 5, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Service management</h3><div class="text-muted small"><p> In this article, we will take a look at how service management is used in Linux, first by defining it, understanding its behavior and configuration, and some useful commands. Note: Im running a Ce...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/maxime-lair/posts/process_management/" class="btn btn-outline-primary" prompt="Older"><p>Process Management</p></a> <a href="/maxime-lair/posts/memory_and_storage/" class="btn btn-outline-primary" prompt="Newer"><p>Memory and storage</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/maxime-lair">Maxime Lair</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/maxime-lair/tags/linux/">linux</a> <a class="post-tag" href="/maxime-lair/tags/bash/">bash</a> <a class="post-tag" href="/maxime-lair/tags/initd/">initd</a> <a class="post-tag" href="/maxime-lair/tags/network/">network</a> <a class="post-tag" href="/maxime-lair/tags/bus/">bus</a> <a class="post-tag" href="/maxime-lair/tags/cadvisor/">cadvisor</a> <a class="post-tag" href="/maxime-lair/tags/concurrency/">concurrency</a> <a class="post-tag" href="/maxime-lair/tags/container/">container</a> <a class="post-tag" href="/maxime-lair/tags/device/">device</a> <a class="post-tag" href="/maxime-lair/tags/docker/">docker</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/maxime-lair/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/maxime-lair/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/maxime-lair/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
